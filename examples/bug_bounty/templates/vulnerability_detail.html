{% extends "base.html" %}

{% block title %}Vulnerability Details - Bug Bounty Hunter Pro{% endblock %}

{% block content %}
<div class="d-flex justify-content-between align-items-center mb-4">
    <h1><i class="fas fa-shield-alt"></i> Vulnerability Details</h1>
    <div>
        <a href="{{ url_for('vulnerabilities') }}" class="btn btn-secondary">
            <i class="fas fa-arrow-left"></i> Back to List
        </a>
        <button class="btn btn-primary">
            <i class="fas fa-paper-plane"></i> Submit Report
        </button>
    </div>
</div>

{% if vulnerability %}
<div class="row">
    <div class="col-md-8">
        <div class="card">
            <div class="card-header">
                <h5>{{ vulnerability[2] }}</h5>
            </div>
            <div class="card-body">
                <div class="mb-3">
                    <strong>Target:</strong> 
                    <a href="https://{{ vulnerability[8] }}" target="_blank" class="text-decoration-none">
                        {{ vulnerability[8] }} <i class="fas fa-external-link-alt fa-xs"></i>
                    </a>
                </div>
                
                <div class="mb-3">
                    <strong>Description:</strong>
                    <p class="mt-2">{{ vulnerability[3] or "No description provided." }}</p>
                </div>
                
                <div class="mb-3">
                    <strong>Proof of Concept:</strong>
                    <div class="bg-dark p-3 rounded mt-2">
                        <code class="text-light">
                            {{ vulnerability[4] or "No PoC provided yet." }}
                        </code>
                    </div>
                </div>
                
                <div class="mb-3">
                    <strong>Remediation:</strong>
                    <p class="mt-2">
                        {% if vulnerability[1] == 'SQL Injection' %}
                            Use parameterized queries and input validation to prevent SQL injection attacks.
                        {% elif vulnerability[1] == 'XSS' %}
                            Implement proper input sanitization and output encoding to prevent XSS attacks.
                        {% elif vulnerability[1] == 'CSRF' %}
                            Implement anti-CSRF tokens and validate the origin of requests.
                        {% else %}
                            Follow security best practices and validate all user inputs.
                        {% endif %}
                    </p>
                </div>
            </div>
        </div>
    </div>
    
    <div class="col-md-4">
        <div class="card">
            <div class="card-header">
                <h5>Summary</h5>
            </div>
            <div class="card-body">
                <div class="mb-3">
                    <strong>Severity:</strong>
                    <span class="badge 
                        {% if vulnerability[2] == 'Critical' %}bg-danger
                        {% elif vulnerability[2] == 'High' %}bg-warning  
                        {% elif vulnerability[2] == 'Medium' %}bg-primary
                        {% else %}bg-secondary{% endif %} ms-2">
                        {{ vulnerability[2] }}
                    </span>
                </div>
                
                <div class="mb-3">
                    <strong>Type:</strong>
                    <span class="badge bg-info ms-2">{{ vulnerability[1] }}</span>
                </div>
                
                <div class="mb-3">
                    <strong>Estimated Payout:</strong>
                    <h4 class="text-success">${{ "%.0f"|format(vulnerability[5]) }}</h4>
                </div>
                
                <div class="mb-3">
                    <strong>Status:</strong>
                    <span class="badge 
                        {% if vulnerability[6] == 'submitted' %}bg-success
                        {% elif vulnerability[6] == 'draft' %}bg-secondary
                        {% elif vulnerability[6] == 'reviewed' %}bg-info
                        {% else %}bg-warning{% endif %} ms-2">
                        {{ vulnerability[6]|title }}
                    </span>
                </div>
                
                <div class="mb-3">
                    <strong>Found:</strong>
                    <small class="text-muted d-block">{{ vulnerability[7] }}</small>
                </div>
                
                <div class="d-grid gap-2">
                    <button class="btn btn-success">
                        <i class="fas fa-edit"></i> Edit Details
                    </button>
                    <button class="btn btn-warning">
                        <i class="fas fa-copy"></i> Duplicate
                    </button>
                    <button class="btn btn-danger">
                        <i class="fas fa-trash"></i> Delete
                    </button>
                </div>
            </div>
        </div>
        
        <div class="card mt-3">
            <div class="card-header">
                <h6>CVSS Score</h6>
            </div>
            <div class="card-body text-center">
                <h2 class="text-warning">
                    {% if vulnerability[2] == 'Critical' %}9.2
                    {% elif vulnerability[2] == 'High' %}7.5
                    {% elif vulnerability[2] == 'Medium' %}5.3
                    {% else %}3.1{% endif %}
                </h2>
                <p class="mb-0">{{ vulnerability[2] }}</p>
            </div>
        </div>
    </div>
</div>
{% else %}
<div class="text-center py-5">
    <i class="fas fa-exclamation-triangle fa-4x text-muted mb-3"></i>
    <h4 class="text-muted">Vulnerability not found</h4>
    <a href="{{ url_for('vulnerabilities') }}" class="btn btn-primary">
        <i class="fas fa-arrow-left"></i> Back to Vulnerabilities
    </a>
</div>
{% endif %}
{% endblock %}
